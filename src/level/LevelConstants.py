# src/level/LevelConstants.py
# ============================================================
# Level 모듈 전체에서 사용하는 상수를 한 곳에서 관리합니다.
# 다른 모듈은 이 파일에서 import 하여 사용합니다.
# ============================================================

import discord

# ===========================================
# 채널 ID
# ===========================================

# LevelSystem 전용
MAIN_CHAT_CHANNEL_ID = 1474014240896585880       # 메인 채팅 채널 (승급 메시지)
QUEST_COMPLETION_CHANNEL_ID = 1474014239436836974 # 퀘스트 완료 알림 채널

# LevelChecker 전용
DIARY_CHANNEL_ID = 1474014240896585882            # 다방일지 채널
CALL_CHANNEL_ID = 1474014240896585884             # 전화하자 채널
FRIEND_CHANNEL_ID = 1474014240896585883           # 친구하자 채널
BOARD_CATEGORY_ID = 1474014240896585886           # 게시판 카테고리

# ===========================================
# 삐삐 퀘스트용 역할 ID
# ===========================================

CALL_ROLE_ID = 1474014231069200445                # 전화하자 역할
FRIEND_ROLE_ID = 1474014231069200446              # 친구하자 역할

# ===========================================
# 역할(경지) 승급 기준 (다공 -> 쪽)
# ===========================================

ROLE_THRESHOLDS = {
    'yeobaek': 0,
    'goyo': 600,
    'seoyu': 3000,
    'seorim': 15000,
    'seohyang': 40000
}

# 역할 순서
ROLE_ORDER = ['yeobaek', 'goyo', 'seoyu', 'seorim', 'seohyang']

# 역할 한글 표시명
ROLE_DISPLAY = {
    'yeobaek': '여백',
    'goyo': '고요',
    'seoyu': '서유',
    'seorim': '서림',
    'seohyang': '서향'
}

# 역할별 디스코드 역할 ID
ROLE_IDS = {
    'yeobaek': 1474014231153082377,
    'goyo': 1474014231153082375,
    'seoyu': 1474014231266459759,
    'seorim': 1474014231266459760,
    'seohyang': 1474014231266459761
}

# 역할별 기호/이모지
ROLE_EMOJI = {
    'yeobaek': '☁️',     # 여백 - 빈 여백, 하얀 시작
    'goyo': '🌙',        # 고요 - 고요한 달빛
    'seoyu': '🦋',       # 서유 - 글 사이를 자유롭게 노니는 나비
    'seorim': '🌳',      # 서림 - 글이 우거진 숲
    'seohyang': '🌸'     # 서향 - 글의 향기
}

# 역할별 폴백 색상 (디스코드 역할 색상을 못 가져올 때 사용)
ROLE_FALLBACK_COLORS = {
    'yeobaek': discord.Color.green(),
    'goyo': discord.Color.from_rgb(144, 238, 144),
    'seoyu': discord.Color.from_rgb(255, 182, 193),
    'seorim': discord.Color.from_rgb(255, 215, 0),
    'seohyang': discord.Color.from_rgb(80, 105, 215)
}

# ===========================================
# 퀘스트 경험치 설정
# ===========================================

QUEST_EXP = {
    'daily': {
        'attendance': 10,
        'diary': 5,
        'voice_30min': 15,
        'bbibbi': 5,
        'call': 3,
        'friend': 3
    },
    'weekly': {
        'recommend_3': 50,
        'attendance_4': 20,
        'attendance_7': 50,
        'diary_4': 10,
        'diary_7': 30,
        'voice_10h': 70,
        'voice_20h': 100,
        'voice_50h': 150,
        'shop_purchase': 30,
        'board_participate': 25,
        'ping_use': 25
    },
    'one_time': {
        'self_intro': 50,
        'review': 80
    }
}

# ===========================================
# 퀘스트 관련 상수
# ===========================================

# 다방일지 최소 글자 수
DIARY_MIN_LENGTH = 5

# 랭크 보상: 5레벨 단위 보상 경험치
RANK_REWARD_EXP_PER_LEVEL = 20
RANK_REWARD_LEVEL_INTERVAL = 5

# 음성방 주간 퀘스트 시간 맵 (시간 -> quest_subtype)
VOICE_WEEKLY_QUEST_MAP = {10: 'voice_10h', 20: 'voice_20h', 50: 'voice_50h'}

# 음성방 주간 시간 기준 (초 단위)
VOICE_WEEKLY_THRESHOLDS = [
    (36000,  '10시간 00분'),    # 10시간
    (72000,  '20시간 00분'),    # 20시간
    (180000, '50시간 00분'),    # 50시간
]

# 퀘스트 완료 시 반응 이모지 풀
REACTION_EMOJI_POOL = [
    '<a:BM_s_001:1477342346512437403>'
]

# ===========================================
# 임베드 이모지 (LevelSystem 사용)
# ===========================================

EMBED_QUEST_TITLE_EMOJI = '<:BM_a_000:1477525641623502950>'
EMBED_QUEST_TITLE_TRAIL = '<a:slg12:1378567364844453938>'
EMBED_PAGE_EMOJI = '<a:BM_n_012:1477349333400551484>'
EMBED_NEW_PAGE_EMOJI = '<a:BM_moon_001:1378716907624202421>'

# ===========================================
# 승급 축하 메시지 템플릿
# ===========================================

ROLE_UPGRADE_TEMPLATES = {
    "goyo": (
        ".  ◜◝--◜◝\n"
        "꒰   ˶ ´  ତ ` ˶꒱\n"
        "✦ ╮ {mention} 님, 고요로 승급했어요 !\n"
        "│\n"
        "│ ⠀차분한 침묵 속에서 나만의 이야기가 비로소 태동하기 시작합니다 ˎˊ˗ \n"
        "│ ⠀하얀 종이 위로 스며드는 잉크처럼\n"
        "│    새로운 글쓰기의 여정이 시작되었습니다 <:BM_k_005:1477540750181924928>\n"
        "│\n"
        " ╰ ⊱ ─ · ─ · ─ · ─ ·  ─ · ─ · ─ · ─ · ─ · ─ · ─ "
    ),
    "seoyu": (
        ".  ◜◝--◜◝\n"
        "꒰   ˶ ´  ତ ` ˶꒱\n"
        "✦ ╮  {mention} 님, 서유로 승급했어요 !\n"
        "│\n"
        "│ ⠀상상과 활자 사이를 쉼 없이 자유롭게 누비는 글쓴이가 되었어요 ˎˊ˗ \n"
        "│ ⠀펼쳐지는 책장마다 피어나는 이야기 속에서\n"
        "│    더 깊은 영감의 세계가 펼쳐집니다 <:BM_k_002:1477540746096545843>\n"
        "│\n"
        " ╰ ⊱ ─ · ─ · ─ · ─ ·  ─ · ─ · ─ · ─ · ─ · ─ · ─"
    ),
    "seorim": (
        ".  ◜◝--◜◝\n"
        "꒰   ˶ ´  ତ ` ˶꒱\n"
        "✦ ╮ {mention} 님, 서림으로 승급했어요 !\n"
        "│\n"
        "│ ⠀문장이 울창하게 우거진 지혜의 숲을 이룬 멋진 작가가 되었어요 ˎˊ˗ \n"
        "│ ⠀깊이 있는 문체로 엮은 책갈피 하나가\n"
        "│    수많은 이들을 동화 속으로 안내합니다 <:BM_k_003:1477540747187326997>\n"
        "│\n"
        " ╰ ⊱ ─ · ─ · ─ · ─ ·  ─ · ─ · ─ · ─ · ─ · ─ · ─"
    ),
    "seohyang": (
        ".   ◜◝--◜◝\n"
        "꒰   ˶ ´  ତ ` ˶꒱\n"
        "✦ ╮ {mention} 님, 서향으로 승급했어요 !\n"
        "│\n"
        "│ ⠀마음을 울리는 글의 향기가, 온 세상에 닿는 명필이 되었어요 ˎˊ˗ \n"
        "│ ⠀정성스레 눌러쓴 한 줄의 다정한 문장이\n"
        "│    모든 경계를 넘어 남는 깊은 울림의 경지입니다 <:BM_k_004:1477540748323979355>\n"
        "│\n"
        " ╰ ⊱ ─ · ─ · ─ · ─ ·  ─ · ─ · ─ · ─ · ─ · ─ · ─"
    ),
}

# ===========================================
# 퀘스트 설명 (quest info 명령어용)
# ===========================================

QUEST_DESCRIPTIONS = {
    'attendance': '매일 서버에 출석하는 퀘스트',
    'diary': '다방일지 채널에 일기를 작성하는 퀘스트',
    'voice_30min': '책방 음성 채널에서 30분 이상 머무르며 이야기를 나누는 퀘스트',
    'call': '특정 채널에서 역할을 멘션하는 통화하자 퀘스트',
    'friend': '특정 채널에서 역할을 멘션하는 친구하자 퀘스트',
    'recommend_3': '서버를 외부 사이트에 3회 추천하는 퀘스트',
    'shop_purchase': '비몽상점에서 상품을 구매하는 퀘스트',
    'board_participate': '비몽게시판에 참여하는 퀘스트',
    'ping_use': '다방삐삐를 사용하는 퀘스트',
    'voice_10h': '주간 책방 음성 채널 10시간 달성 퀘스트',
    'voice_20h': '주간 책방 음성 채널 20시간 달성 퀘스트',
    'voice_50h': '주간 책방 음성 채널 50시간 달성 퀘스트',
    'attendance_4': '주간 출석 4회 달성 시 자동 완료',
    'attendance_7': '주간 출석 7회 달성 시 자동 완료',
    'diary_4': '주간 다방일지 4회 달성 시 자동 완료',
    'diary_7': '주간 다방일지 7회 달성 시 자동 완료',
    'self_intro': '여백 카테고리에 자기소개 채널을 만드는 퀘스트',
    'review': '디코올에 서버 후기를 작성하는 퀘스트'
}

QUEST_CATEGORY_NAMES = {
    'daily': '📅 일일 퀘스트',
    'weekly': '📊 주간 퀘스트',
    'one_time': '✨ 일회성 퀘스트'
}

# ===========================================
# 유틸리티 함수
# ===========================================

def get_role_info():
    """LevelConfig.py 등에서 사용되는 통합 딕셔너리를 반환"""
    return {
        key: {
            'name': ROLE_DISPLAY[key],
            'threshold': ROLE_THRESHOLDS[key],
            'emoji': ROLE_EMOJI[key],
            'id': ROLE_IDS[key]
        }
        for key in ROLE_ORDER
    }
